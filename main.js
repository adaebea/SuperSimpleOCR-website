const translations = {
  en: {
    "hero.title": `SuperSimpleOCR Support`,
    "hero.subtitle": `Your simple Mac menu-bar OCR assistant.`,
    "overview.title": `Overview`,
    "overview.body": `SuperSimpleOCR is a lightweight menu-bar application for macOS that allows you to quickly capture and extract text from your screen. This support page provides installation instructions, usage guidance and answers to common questions.`,
    "installation.title": `Installation`,
    "installation.body": `1. Download the latest release of SuperSimpleOCR from Mac App Store. 2. Open the downloaded file and drag the application into your <em>Applications</em> folder. 3. Launch the app from your Applications folder. On first run, macOS may prompt for screen-recording permission; grant this so the app can capture text from your screen.`,
    "usage.title": `How to Use`,
    "usage.body": `• Use the shortcut <span class="shortcut"><span>Control</span><span>Option</span><span>C</span></span> to capture and recognize text, then paste it anywhere you want.`,
    "faq.title": `FAQ`,
    "faq.q1": `Why does SuperSimpleOCR need screen recording permission?`,
    "faq.a1": `The app captures a portion of your screen to run OCR and extract text. macOS requires user permission for any application that records the screen.`,
    "faq.q2": `Where can I report bugs or request features?`,
    "faq.a2": `You can reach out via the contact email below.`,
    "contact.title": `Contact`,
    "contact.body1": `If you encounter any issues or need further assistance, feel free to email us at <a href='mailto:adaebea@gmail.com'>adaebea@gmail.com</a>.`,
    "contact.body2": `Please also review our <a href='privacy-policy.html'>Privacy Policy</a> to understand how we handle your data.`,
    "language.label": `Language`,
    "footer.copy": `&copy; 2025 SuperSimpleOCR. All rights reserved.`,
  },
  zh: {
    "hero.title": `SuperSimpleOCR 支持`,
    "hero.subtitle": `简洁的 Mac 菜单栏 OCR 助手。`,
    "overview.title": `概览`,
    "overview.body": `SuperSimpleOCR 是一款轻量级的 macOS 菜单栏应用，可快速捕捉屏幕并提取文字。本页面提供安装步骤、使用指南以及常见问题解答。`,
    "installation.title": `安装`,
    "installation.body": `1. 从 Mac App Store 下载最新版本 SuperSimpleOCR。2. 打开下载的文件并将应用拖入 <em>Applications</em> 文件夹。3. 从应用程序文件夹启动。首次运行时需要授予屏幕录制权限，以便应用截取文字。`,
    "usage.title": `使用方法`,
    "usage.body": `• 使用快捷键 <span class="shortcut"><span>Control</span><span>Option</span><span>C</span></span> 来截取并识别文字，然后将结果粘贴到任意位置。`,
    "faq.title": `常见问题`,
    "faq.q1": `为什么需要屏幕录制权限？`,
    "faq.a1": `应用需要截取屏幕区域来执行 OCR 并提取文本，macOS 要求此操作必须获得用户授权。`,
    "faq.q2": `在哪里报告问题或提交功能需求？`,
    "faq.a2": `请通过下方的联系邮箱与我们取得联系。`,
    "contact.title": `联系方式`,
    "contact.body1": `如果遇到任何问题或需要进一步帮助，请发送邮件至 <a href='mailto:adaebea@gmail.com'>adaebea@gmail.com</a>。`,
    "contact.body2": `请阅读我们的 <a href='privacy-policy.html'>隐私政策</a>，了解数据处理方式。`,
    "language.label": `语言`,
    "footer.copy": `&copy; 2025 SuperSimpleOCR。保留所有权利。`,
  },
  ja: {
    "hero.title": `SuperSimpleOCR サポート`,
    "hero.subtitle": `シンプルな Mac メニューバー OCR アシスタント。`,
    "overview.title": `概要`,
    "overview.body": `SuperSimpleOCR は macOS 用の軽量メニューバーアプリで、画面から素早くテキストをキャプチャして抽出できます。本ページではインストール手順、使い方、FAQ をご案内します。`,
    "installation.title": `インストール`,
    "installation.body": `1. Mac App Store から SuperSimpleOCR の最新版をダウンロードします。2. ダウンロードしたファイルを開き、アプリを <em>Applications</em> フォルダにドラッグします。3. アプリケーションから起動します。初回起動時には画面収録の許可を求められるため、OCR のために許可してください。`,
    "usage.title": `使い方`,
    "usage.body": `• ショートカット <span class="shortcut"><span>Control</span><span>Option</span><span>C</span></span> を使ってテキストを取得し、必要な場所に貼り付けます。`,
    "faq.title": `FAQ`,
    "faq.q1": `SuperSimpleOCR が画面収録の許可を求めるのはなぜですか？`,
    "faq.a1": `画面の一部をキャプチャして OCR を実行する必要があり、macOS ではそのための許可が必要です。`,
    "faq.q2": `不具合報告や機能要望はどこに送ればいいですか？`,
    "faq.a2": `以下のメールアドレスからご連絡ください。`,
    "contact.title": `お問い合わせ`,
    "contact.body1": `問題が発生した場合やサポートが必要な場合は <a href='mailto:adaebea@gmail.com'>adaebea@gmail.com</a> までご連絡ください。`,
    "contact.body2": `データの取り扱いについては <a href='privacy-policy.html'>プライバシーポリシー</a> をご覧ください。`,
    "language.label": `言語`,
    "footer.copy": `&copy; 2025 SuperSimpleOCR. すべての権利を保有します。`,
  },
  ko: {
    "hero.title": `SuperSimpleOCR 지원`,
    "hero.subtitle": `간단한 Mac 메뉴 막대 OCR 도우미.`,
    "overview.title": `개요`,
    "overview.body": `SuperSimpleOCR는 macOS용 경량 메뉴 막대 앱으로, 화면에서 텍스트를 빠르게 캡처하고 추출합니다. 이 지원 페이지에서 설치 방법, 사용 팁, 자주 묻는 질문을 확인하세요.`,
    "installation.title": `설치`,
    "installation.body": `1. Mac App Store에서 SuperSimpleOCR 최신 버전을 다운로드하세요. 2. 다운로드한 파일을 열어 앱을 <em>Applications</em> 폴더로 드래그합니다. 3. 응용 프로그램 폴더에서 앱을 실행하세요. 처음 실행 시 화면 기록 권한 요청이 나타나면 OCR을 위해 허용해 주세요.`,
    "usage.title": `사용 방법`,
    "usage.body": `• <span class="shortcut"><span>Control</span><span>Option</span><span>C</span></span> 단축키로 텍스트를 캡처하고 인식한 뒤 원하는 곳에 붙여넣으세요.`,
    "faq.title": `FAQ`,
    "faq.q1": `왜 화면 기록 권한이 필요한가요?`,
    "faq.a1": `앱이 화면 일부를 캡처해 OCR을 수행해야 하며, macOS에서는 이러한 작업에 사용자 허가가 필요합니다.`,
    "faq.q2": `버그 신고나 기능 요청은 어디로 보내야 하나요?`,
    "faq.a2": `아래의 연락처 이메일로 보내 주세요.`,
    "contact.title": `문의`,
    "contact.body1": `문제가 있거나 추가 지원이 필요하면 <a href='mailto:adaebea@gmail.com'>adaebea@gmail.com</a> 으로 메일을 보내 주세요.`,
    "contact.body2": `데이터 처리 방식은 <a href='privacy-policy.html'>개인정보 처리방침</a>을 확인해 주세요.`,
    "language.label": `언어`,
    "footer.copy": `&copy; 2025 SuperSimpleOCR. 모든 권리를 보유합니다.`,
  },
  fr: {
    "hero.title": `Assistance SuperSimpleOCR`,
    "hero.subtitle": `Votre assistant OCR simple dans la barre de menu Mac.`,
    "overview.title": `Présentation`,
    "overview.body": `SuperSimpleOCR est une application légère pour la barre de menu macOS qui permet de capturer rapidement l'écran et d'en extraire du texte. Cette page d'assistance fournit les instructions d'installation, des conseils d'utilisation et les réponses aux questions fréquentes.`,
    "installation.title": `Installation`,
    "installation.body": `1. Téléchargez la dernière version de SuperSimpleOCR sur le Mac App Store. 2. Ouvrez le fichier téléchargé et faites glisser l'application dans le dossier <em>Applications</em>. 3. Lancez l'app depuis ce dossier. Au premier démarrage, macOS peut demander l'autorisation d'enregistrement d'écran ; accordez-la pour permettre la capture de texte.`,
    "usage.title": `Utilisation`,
    "usage.body": `• Utilisez le raccourci <span class="shortcut"><span>Control</span><span>Option</span><span>C</span></span> pour capturer et reconnaître du texte, puis collez-le où vous voulez.`,
    "faq.title": `FAQ`,
    "faq.q1": `Pourquoi SuperSimpleOCR demande-t-il une autorisation d'enregistrement d'écran ?`,
    "faq.a1": `L'application capture une partie de votre écran pour exécuter l'OCR et extraire du texte. macOS exige votre autorisation pour toute application qui enregistre l'écran.`,
    "faq.q2": `Où signaler des bugs ou demander de nouvelles fonctionnalités ?`,
    "faq.a2": `Contactez-nous via l'adresse e-mail ci-dessous.`,
    "contact.title": `Contact`,
    "contact.body1": `Si vous rencontrez des problèmes ou avez besoin d'aide, écrivez-nous à <a href='mailto:adaebea@gmail.com'>adaebea@gmail.com</a>.`,
    "contact.body2": `Consultez également notre <a href='privacy-policy.html'>politique de confidentialité</a> pour comprendre comment nous gérons vos données.`,
    "language.label": `Langue`,
    "footer.copy": `&copy; 2025 SuperSimpleOCR. Tous droits réservés.`,
  },
};

const l10nElements = document.querySelectorAll("[data-l10n]");
const languageButtons = Array.from(
  document.querySelectorAll(".language-switcher button")
);

function setLanguage(lang) {
  const dictionary = translations[lang] || translations.en;
  document.documentElement.lang = lang;
  l10nElements.forEach((element) => {
    const key = element.dataset.l10n;
    if (dictionary[key]) {
      element.innerHTML = dictionary[key];
    }
  });
  languageButtons.forEach((btn) =>
    btn.classList.toggle("active", btn.dataset.lang === lang)
  );
}

languageButtons.forEach((btn) => {
  btn.addEventListener("click", () => setLanguage(btn.dataset.lang));
});

setLanguage("en");

// Simple FAQ accordion
document.querySelectorAll(".faq-question").forEach(function (q) {
  q.addEventListener("click", function () {
    var answer = this.nextElementSibling;
    answer.style.display = answer.style.display === "block" ? "none" : "block";
  });
});

// Hero carousel fan animation
const heroCarousel = document.querySelector(".hero-carousel");
const heroImages = Array.from(document.querySelectorAll(".hero-carousel img"));
let activeHeroIndex = 0;

// Keep carousel height aligned to the intrinsic aspect ratio of the images
function updateHeroAspectRatio() {
  if (!heroCarousel || !heroImages.length) return;
  const baseImage = heroImages[0];
  const applyRatio = (img) => {
    if (img.naturalWidth && img.naturalHeight) {
      const ratio = img.naturalHeight / img.naturalWidth;
      heroCarousel.style.setProperty("--hero-ratio", ratio);
    }
  };
  if (baseImage.complete) {
    applyRatio(baseImage);
  } else {
    baseImage.addEventListener("load", () => applyRatio(baseImage), {
      once: true,
    });
  }
}

function updateHeroImages() {
  if (!heroImages.length) return;
  const total = heroImages.length;
  const center = activeHeroIndex % total;
  const left = (center - 1 + total) % total;
  const right = (center + 1) % total;

  heroImages.forEach((img, index) => {
    img.classList.remove("left", "center", "right");
    if (index === center) img.classList.add("center");
    else if (index === left) img.classList.add("left");
    else if (index === right) img.classList.add("right");
  });
}

function changeHeroIndex(direction) {
  if (!heroImages.length) return;
  const total = heroImages.length;
  activeHeroIndex = (activeHeroIndex + direction + total) % total;
  updateHeroImages();
}

updateHeroImages();
if (heroImages.length) {
  updateHeroAspectRatio();
  setInterval(() => changeHeroIndex(1), 4000);
}

if (heroCarousel) {
  let heroPointerActive = false;
  let heroPointerStartX = 0;

  const heroPointerThreshold = 40;

  heroCarousel.addEventListener("pointerdown", (event) => {
    heroPointerActive = true;
    heroPointerStartX = event.clientX;
    heroCarousel.setPointerCapture(event.pointerId);
  });

  heroCarousel.addEventListener("pointermove", (event) => {
    if (!heroPointerActive) return;
    const deltaX = event.clientX - heroPointerStartX;
    if (Math.abs(deltaX) > heroPointerThreshold) {
      changeHeroIndex(deltaX > 0 ? -1 : 1);
      heroPointerActive = false;
      heroCarousel.releasePointerCapture(event.pointerId);
    }
  });

  const stopHeroSwipe = (event) => {
    if (!heroPointerActive) return;
    heroPointerActive = false;
    heroCarousel.releasePointerCapture(event.pointerId);
  };

  heroCarousel.addEventListener("pointerup", stopHeroSwipe);
  heroCarousel.addEventListener("pointercancel", stopHeroSwipe);
  heroCarousel.addEventListener("pointerleave", stopHeroSwipe);
}
